# Repository Settings
DATALABS_PYTHONPATH='{{pythonpath}}'

# Project Settings
PROJECT_NAME='OneView'

TASK_CLASS=datalabs.etl.task.ETLTask
TASK_WRAPPER_CLASS=datalabs.etl.awslambda.ETLTaskWrapper

# Extractor
EXTRACTOR__TASK_CLASS=datalabs.etl.sql.sqlalchemy.extract.SQLAlchemyExtractorTask
EXTRACTOR__DATABASE_BACKEND=mssql+pymssql
EXTRACTOR__DATABASE_HOST=pe-dev-aurora-cluster.cluster-cwp4vd8mllvz.us-east-1.rds.amazonaws.com
EXTRACTOR__DATABASE_PORT='3306'
EXTRACTOR__DATABASE_NAME='usermgmt'
EXTRACTOR__DATABASE_USERNAME=platform
EXTRACTOR__DATABASE_PASSWORD='{{db_password}}'
EXTRACTOR__SQL="
SELECT distinct(u.email) FROM User u INNER JOIN User_Group_Assignment uga on u.id = uga.user_id
    INNER JOIN Groups g on g.id = uga.group_id
    WHERE TIMESTAMPDIFF(MONTH, g.valid_from, current_date()) = 11 AND g.renewal_reminders  = 0 ORDER BY email;
"
EXTRACTOR__CHUNK_SIZE='100000'
EXTRACTOR__EXTRACT_EMAILS__CACHE_OUTPUT_FILES: email_addresses.csv


# Pass-through Transformer
TRANSFORMER__TASK_CLASS=datalabs.etl.intelligent_platform.licensing.email.ReminderEmailTask

