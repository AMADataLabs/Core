openapi: 3.0.2
info:
  title: Vignettes API
  description: CPT Vignettes API
  version: 1.0.0
  termsOfService: 'http://swagger.io/terms/'
  contact:
    email: datalabs@ama-assn.org
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
tags:
  - name: Vignette
    description: A CPT code vignette
    externalDocs:
      url: 'http://swagger.io'
paths:
  /vignette/{cpt_code}:
    get:
      tags:
        - Vignette
      summary: Endpoint to search vignettes using cpt codes
      description: Return vignette of given CPT Code
      operationId: getVignette
      parameters:
        - name: cpt_code
          in: path
          description: CPT Code
          required: true
          schema:
            type: integer
            minimum: 1
        - name: additional_information
          in: query
          description: Return additional information for vingette
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vignette'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '408':
          description: Request Timeout
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '500':
          description: Internal Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
  /{proxy+}:
    get:
      parameters:
        - name: proxy
          in: path
          required: true
          schema:
            type: string
      x-amazon-apigateway-integration:
        uri: "arn:aws:apigateway:${region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${region}:${account_id}:function:${project}-${environment}-SNOMED-API/invocations"
        responses:
          default:
            statusCode: 200
        passthroughBehavior: "when_no_match"
        httpMethod: "POST"
        cacheNamespace: "www3v9"
        cacheKeyParameters:
          - "method.request.path.proxy"
        type: "aws_proxy"
      responses:
        '404':
          description: Invalid resource.
      security:
        - gateway_authorizer: []
components:
  schemas:  
    Vignette:
      type: object
      required:
        - code
        - patient
        - pre_service
        - intra_service
        - post_service
      properties:
        code:
          type: string
        patient:
          type: string
        pre_service:
          type: string
        intra_service: 
          type: string
        post-service:
          type: string
        ruc:
          type: string
        specialty:
          type: string
        concept_id:
          type: string
    ErrorDetails:
      type: object
      properties:
        ErrorCode:
          type: string
          nullable: true
        ErrorClass:
          type: string
          nullable: true
        Message:
          type: string
          nullable: true
  securitySchemes:
    gateway_authorizer:
      type: apiKey
      name: Authorization
      in: header
      x-amazon-apigateway-authtype: "custom"
      x-amazon-apigateway-authorizer:
        type: token
        authorizerUri: ${authorizer_uri}
externalDocs:
  description: Find out more about Swagger
  url: 'http://swagger.io'
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/RNAJEEB_1/Vignettes_API/1.0.0
