openapi: 3.0.2
info:
  title: Vignettes API
  description: CPT Vignettes API
  version: 1.0.0
  termsOfService: 'http://swagger.io/terms/'
  contact:
    email: datalabs@ama-assn.org
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
tags:
  - name: Vignette
    description: A CPT code vignette
    externalDocs:
      url: 'http://swagger.io'
  - name: Default 404 
    description: Default invalid resource error response
    externalDocs:
      url: 'http://swagger.io'
paths:
  /vignette/{cpt_code}:
    get:
      tags:
        - Vignette
      summary: Endpoint to search vignettes using cpt codes
      description: Return vignette of given CPT Code
      operationId: getVignette
      parameters:
        - name: cpt_code
          in: path
          description: CPT Code
          required: true
          schema:
            type: integer
            minimum: 1
        - name: additional_information
          in: query
          description: Return additional information for vingette
          required: false
          schema:
            type: boolean
      x-amazon-apigateway-integration:
        uri: "${invocation_uri}"
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Vignette'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '404':
          description: No data available
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '408':
          description: Request Timeout
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
        '500':
          description: Internal Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorDetails'
  /{proxy+}:
    get:
      tags:
        - Default 404 
      parameters:
        - name: proxy
          in: path
          required: true
          schema:
            type: string
      x-amazon-apigateway-integration:
        uri: "${invocation_uri}"
        responses:
          default:
            statusCode: 200
        passthroughBehavior: "when_no_match"
        httpMethod: "POST"
        cacheNamespace: "www3v9"
        cacheKeyParameters:
          - "method.request.path.proxy"
        type: "aws_proxy"
      responses:
        '404':
          description: Invalid resource.
      security:
        - gateway_authorizer: []
components:
  schemas:  
    Vignette:
      type: object
      required:
        - cpt_code
        - typical_patient
        - pre_service_info
        - intra_service_info
        - post_service_info
      properties:
        cpt_code:
          type: string
          description: CPT code associated with vignette
        typical_patient:
          type: string
          description: Typical patient description or null
        pre_service_info:
          type: string
          description: Physician work provided before the onset of the procedure
        intra_service_info: 
          type: string
          description: Physician work provided during the onset of the procedure
        post_service_info:
          type: string
          description: Physician work provided after the onset of the procedure
        ruc_reviewed_date:
          type: string
          description: If applicable, date reviewed by RUC committee
        concept_id:
          type: string
          description: AMA internal Concept identifier
    ErrorDetails:
      type: object
      properties:
        ErrorCode:
          type: string
          nullable: true
        ErrorClass:
          type: string
          nullable: true
        Message:
          type: string
          nullable: true
  securitySchemes:
    gateway_authorizer:
      type: apiKey
      name: Authorization
      in: header
      x-amazon-apigateway-authtype: "custom"
      x-amazon-apigateway-authorizer:
        type: token
        authorizerUri: ${authorizer_uri}
externalDocs:
  description: Find out more about Swagger
  url: 'http://swagger.io'
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/RNAJEEB_1/Vignettes_API/1.0.0